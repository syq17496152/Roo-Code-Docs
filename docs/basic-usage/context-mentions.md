# 上下文引用

上下文引用是一种强大的方式，可以为 Roo Code 提供有关您项目的特定信息，使其能够更准确和高效地执行任务。您可以使用引用指向文件、文件夹、问题和 Git 提交。上下文引用以 `@` 符号开头。

<img src="/img/context-mentions/context-mentions.png" alt="上下文引用概述 - 显示聊天界面中的 @ 符号下拉菜单" width="600" />

*上下文引用概述，显示聊天界面中的 @ 符号下拉菜单。*

---

## 引用类型

<img src="/img/context-mentions/context-mentions-1.png" alt="文件引用示例，显示通过 @ 引用的文件及其内容在对话中出现" width="600" />

*文件引用将实际代码内容添加到对话中以便直接参考和分析。*

| 引用类型 | 格式 | 描述 | 示例用法 |
|--------------|--------|-------------|--------------|
| **文件** | `@/path/to/file.ts` | 在请求上下文中包含文件内容 | "解释 @/src/utils.ts 中的函数" |
| **文件夹** | `@/path/to/folder` | 包含文件夹中所有文件的内容（非递归） | "分析 @/src/components 中的代码" |
| **问题** | `@problems` | 包含 VS Code 问题面板的诊断信息 | "@problems 修复我代码中的所有错误" |
| **终端** | `@terminal` | 包含最近的终端命令和输出 | "修复 @terminal 中显示的错误" |
| **Git 提交** | `@a1b2c3d` | 通过哈希引用特定提交 | "提交 @a1b2c3d 中有什么变化？" |
| **Git 变更** | `@git-changes` | 显示未提交的变更 | "为 @git-changes 建议一个提交信息" |
| **URL** | `@https://example.com` | 导入网站内容 | "总结 @https://docusaurus.io/ 内容" |

### 文件引用

<img src="/img/context-mentions/context-mentions-1.png" alt="文件引用示例，显示通过 @ 引用的文件及其内容在对话中出现" width="600" />

*文件引用结合了带行号的源代码以便精确参考。*
| 功能 | 详情 |
|------------|---------|
| **格式** | `@/path/to/file.ts` (始终从工作区根目录开始) |
| **提供** | 完整的文件内容并带有行号 |
| **支持** | 文本文件、PDF 和 DOCX 文件（带文本提取） |
| **适用场景** | 初始请求、反馈响应和后续消息 |
| **局限性** | 非常大的文件可能会被截断；不支持二进制文件 |

### 文件夹引用

<img src="/img/context-mentions/context-mentions-2.png" alt="文件夹引用示例，显示在聊天中引用的目录内容" width="600" />

*文件夹引用包含指定目录内所有文件的内容。*
| 功能 | 详情 |
|------------|---------|
| **格式** | `@/path/to/folder` (不带尾部斜杠) |
| **提供** | 目录内所有文件的完整内容 |
| **包含** | 文件夹内的非二进制文本文件内容（不包括子目录） |
| **最佳用途** | 提供来自目录中多个文件的上下文 |
| **提示** | 当引用大型目录时，请注意上下文窗口限制 |

### 问题引用

<img src="/img/context-mentions/context-mentions-3.png" alt="问题引用示例，显示通过 @problems 引用的 VS Code 问题面板" width="600" />

*问题引用直接从 VS Code 的问题面板导入诊断信息。*
| 功能 | 详情 |
|------------|---------|
| **格式** | `@problems` |
| **提供** | 来自 VS Code 问题面板的所有错误和警告 |
| **包含** | 文件路径、行号和诊断信息 |
| **分组** | 按文件组织问题以便更好地清晰度 |
| **最佳用途** | 无需手动复制即可修复错误 |

### 终端引用
<img src="/img/context-mentions/context-mentions-4.png" alt="终端引用示例，显示包含在 Roo 上下文中的终端输出" width="600" />

*终端引用捕获最近的命令输出用于调试和分析。*

| 功能 | 详情 |
|------------|---------|
| **格式** | `@terminal` |
| **捕获** | 最后一条命令及其完整输出 |
| **保留** | 终端状态（不会清除终端） |
| **局限性** | 仅限于可见的终端缓冲区内容 |
| **最佳用途** | 调试构建错误或分析命令输出 |

### Git 引用

<img src="/img/context-mentions/context-mentions-5.png" alt="Git 提交引用示例，显示 Roo 分析提交详细信息" width="600" />

*Git 引用提供提交详细信息和差异，用于上下文感知版本分析。*
| 类型 | 格式 | 提供 | 局限性 |
|------|--------|----------|------------|
| **提交** | `@a1b2c3d` | 提交信息、作者、日期和完整差异 | 仅适用于 Git 仓库 |
| **工作变更** | `@git-changes` | `git status` 输出和未提交变更的差异 | 仅适用于 Git 仓库 |

### URL 引用
<img src="/img/context-mentions/context-mentions-6.png" alt="URL 引用示例，显示在聊天中转换为 Markdown 的网页内容" width="600" />

*URL 引用导入外部网页内容并将其转换为可读的 Markdown 格式。*

| 功能 | 详情 |
|------------|---------|
| **格式** | `@https://example.com` |
| **处理** | 使用无头浏览器获取内容 |
| **清理** | 移除脚本、样式和导航元素 |
| **输出** | 将内容转换为 Markdown 以提高可读性 |
| **局限性** | 复杂页面可能无法完美转换 |

---

## 如何使用引用

1. 在聊天输入框中输入 `@` 以触发建议下拉菜单
2. 继续输入以过滤建议或使用箭头键导航
3. 按 Enter 键或鼠标点击选择
4. 在请求中组合多个引用："修复 @problems 中的 @/src/component.ts 错误"

下拉菜单会自动建议：
- 最近打开的文件
- 可见的文件夹
- 最近的 git 提交
- 特殊关键字 (`problems`, `terminal`, `git-changes`)
- **所有当前打开的文件** (不管忽略设置或目录过滤器如何)

下拉菜单还会自动过滤掉常见的目录如 `node_modules`、`.git`、`dist` 和 `out` 以减少干扰，即使这些目录的内容可以通过手动输入包含进来。

---

## 重要行为

### 忽略文件交互

| 行为 | 描述 |
|----------|-------------|
| **`.rooignore` 绕过** | 文件和文件夹 `@mentions` 在获取上下文内容时绕过 `.rooignore` 检查。如果直接引用，被忽略文件的内容仍将被包含。 |
| **`.gitignore` 绕过** | 同样，文件和文件夹 `@mentions` 在获取内容时不遵守 `.gitignore` 规则。 |
| **Git 命令遵守** | Git 相关的引用 (`@git-changes`, `@commit-hash`) 会遵守 `.gitignore`，因为它们依赖于 Git 命令。 |